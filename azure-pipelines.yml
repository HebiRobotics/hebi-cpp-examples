# # Starter pipeline
# # Start with a minimal pipeline that you can customize to build and deploy your code.
# # Add steps that build, run tests, deploy, and more:
# # https://aka.ms/yaml

# trigger:
# - master
# - hardik/arm_examples_2
# - CI_Test

# # pool:
# #   vmImage: 'ubuntu-16.04'

# # These steps are the only job being run, in every container.
# # jobs:
# # - job: test_linux

# pool: 
#   vmImage: 'ubuntu-16.04'

# container: 
#     # image: $[variables['containerImage']]
#     image: ubuntu:18.04
#     options: --user root

# steps:
# - task: UsePythonVersion@0
#   inputs:
#     versionSpec: '3.x'
#     addToPath: true
#     architecture: 'x64'

# - bash: |
#     apt
#     apt-get install python-numpy
#     mkdir build
#     cd build
#     cmake ../projects/cmake/
#     make
#   displayName: 'Testing build on ubuntu'

variables:
  ubuntu14: 'ubuntu:14.04'
  ubuntu16: 'ubuntu:16.04'
  ubuntu18: 'ubuntu:18.04'

jobs:
- job: test_linux
  
  pool:
    vmImage: 'ubuntu-16.04'
    name: Hosted Ubuntu 1604
  container:
    image: $(ubuntu18)
    options: --user root

  steps:
#   - checkout: none

#   - download: current
#     artifact: cmake

#   - download: current
#     artifact: ci

  - bash: |
      mkdir build
      cd build
      cmake ../projects/cmake/
      make
    displayName: 'Build Linux x86_64'

  - task: CMake@1
    inputs:
      cmakeArgs: '../projects/cmake/'


###
# Kind of working
###
# resources:
#   containers:
#   - container: u14
#     image: ubuntu:14.04

#   - container: u16
#     image: ubuntu:16.04

#   - container: u18
#     image: ubuntu:18.04

# jobs:
# - job: RunInContainer
#   pool:
#     vmImage: 'ubuntu-16.04'

#   strategy:
#     matrix:
#       ubuntu14:
#         containerResource: u14
#       ubuntu16:
#         containerResource: u16
#       ubuntu18:
#         containerResource: u18

#   container: $[ variables['containerResource'] ]

#   steps:
#     - bash: |
#         apt
#         sudo apt-get install python-numpy
#         mkdir build
#         cd build
#         echo $PATH
#       displayName: 'Testing build on main ubuntu14/16/18'

    